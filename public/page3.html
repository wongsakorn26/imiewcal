<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Imiew Mobile</title>
    <link rel="icon" type="image/x-icon" href="pic/imiew.jpg" />
    <link rel="stylesheet" href="./style/page3.css" />
    <script>
      function disableInputs() {
        const downChoice = document.getElementById("downChoice").value
        const radioButtons = document.getElementsByName("downPercent")

        radioButtons.forEach((radio) => {
          radio.disabled = downChoice !== ""
        })

        const isAnyRadioChecked = Array.from(radioButtons).some(
          (radio) => radio.checked
        )
        document.getElementById("downChoice").disabled = isAnyRadioChecked
      }

      function resetRadioButtons() {
        document
          .querySelectorAll('input[name="downPercent"]')
          .forEach((radio) => (radio.checked = false))
        document.getElementById("downChoice").disabled = false
      }

      function cal() {
        const price = parseFloat(document.getElementById("price1").value)
        const downChoice = parseFloat(
          document.getElementById("downChoice").value
        )
        let downPaymentPercent
        let installmentPeriod
        let installmentPeriods

        if (!isNaN(downChoice) && downChoice > 0) {
          if (downChoice >= price) {
            alert("ราคาดาวน์ต้องน้อยกว่าราคาสด")
            return
          }
          downPaymentPercent = downChoice / price
        } else {
          downPaymentPercent = {
            radio10: 0.1,
            radio20: 0.2,
            radio30: 0.3,
            radio40: 0.4,
            radio50: 0.5,
          }[document.querySelector('input[name="downPercent"]:checked')?.id]

          if (!downPaymentPercent) {
            alert("ข้อมูลไม่ครบ")
            return
          }
        }

        installmentPeriod = document.querySelector(
          'input[name="installmentPeriod"]:checked'
        )?.value
        installmentPeriods = installmentPeriod

        if (!installmentPeriod) {
          alert("Please select an installment period.")
          return
        }

        const downPayment = price * downPaymentPercent
        const sum = Math.ceil(downPayment)
        const cal_cap = price - sum
        const sum2 = 950
        const installmentRates = {
          4: 0.23,
          8: 0.33,
          12: 0.43,
          16: 0.53,
          20: 0.63,
          24: 0.73,
          28: 0.83,
          32: 0.93,
          36: 1.03,
          40: 1.13,
          44: 1.23,
          46: 1.23,
          1: 0.23,
          2: 0.33,
          3: 0.43,
          4: 0.53,
          5: 0.63,
          6: 0.73,
          7: 0.83,
          8: 0.93,
          9: 1.03,
          10: 1.13,
          11: 1.23,
          12: 1.23,
        }

        if (installmentPeriod) {
          const rate = installmentRates[installmentPeriod]
          const pricePerInstallment = Math.ceil(
            (cal_cap + cal_cap * rate + sum2) / installmentPeriod
          )

          const field = document.getElementById("field")
          field.innerHTML = `
            ราคาวางดาวน์: ${sum}<br>
            ราคาหักวางดาวน์: ${cal_cap}<br>
            งวด: ${installmentPeriod} งวด ราคาต่องวด: ${pricePerInstallment}
          `
        } else {
          alert("Invalid installment period.")
        }
      }
    </script>
  </head>
  <body>
    <div class="container">
      <h1>Imiew Mobile</h1>
      <label for="price1">ราคาสด: </label>
      <input type="number" id="price1" />
      <br />
      <label for="downChoice">ราคาวางดาวน์: </label>
      <input type="number" id="downChoice" oninput="disableInputs()" />
      <br />
      <h2>หรือเลือกเปอร์เซ็นต์วางดาวน์</h2>
      <button onclick="resetRadioButtons()" style="background-color: red">
        รีเซ็ตเปอร์เซ็นต์วางดาวน์
      </button>

      <div class="radio-group">
        <input
          type="radio"
          id="radio10"
          name="downPercent"
          onchange="disableInputs()"
        />
        <label for="radio10">10%</label>
        <input
          type="radio"
          id="radio20"
          name="downPercent"
          onchange="disableInputs()"
        />
        <label for="radio20">20%</label>
        <input
          type="radio"
          id="radio30"
          name="downPercent"
          onchange="disableInputs()"
        />
        <label for="radio30">30%</label>
        <input
          type="radio"
          id="radio40"
          name="downPercent"
          onchange="disableInputs()"
        />
        <label for="radio40">40%</label>
        <input
          type="radio"
          id="radio50"
          name="downPercent"
          onchange="disableInputs()"
        />
        <label for="radio50">50%</label>
      </div>
      <h2>เลือกงวดการผ่อนชำระ</h2>
      <h3>รายสัปดาห์</h3>
      <div class="radio-group">
        <input type="radio" id="do4" name="installmentPeriod" value="4" />
        <label for="do4">4 งวด</label>
        <input type="radio" id="do8" name="installmentPeriod" value="8" />
        <label for="do8">8 งวด</label>
        <input type="radio" id="do12" name="installmentPeriod" value="12" />
        <label for="do12">12 งวด</label>
        <input type="radio" id="do16" name="installmentPeriod" value="16" />
        <label for="do16">16 งวด</label>
        <input type="radio" id="do20" name="installmentPeriod" value="20" />
        <label for="do20">20 งวด</label>
        <input type="radio" id="do24" name="installmentPeriod" value="24" />
        <label for="do24">24 งวด</label>
        <input type="radio" id="do28" name="installmentPeriod" value="28" />
        <label for="do28">28 งวด</label>
        <input type="radio" id="do32" name="installmentPeriod" value="32" />
        <label for="do32">32 งวด</label>
        <input type="radio" id="do36" name="installmentPeriod" value="36" />
        <label for="do36">36 งวด</label>
        <input type="radio" id="do40" name="installmentPeriod" value="40" />
        <label for="do40">40 งวด</label>
        <input type="radio" id="do44" name="installmentPeriod" value="44" />
        <label for="do44">44 งวด</label>
        <input type="radio" id="do46" name="installmentPeriod" value="46" />
        <label for="do46">46 งวด</label>
      </div>
      <h3>รายเดือน</h3>
      <div class="radio-group">
        <input type="radio" id="mo1" name="installmentPeriod" value="1" />
        <label for="mo1">1 งวด</label>
        <input type="radio" id="mo2" name="installmentPeriod" value="2" />
        <label for="mo2">2 งวด</label>
        <input type="radio" id="mo3" name="installmentPeriod" value="3" />
        <label for="mo3">3 งวด</label>
        <input type="radio" id="mo4" name="installmentPeriod" value="4" />
        <label for="mo4">4 งวด</label>
        <input type="radio" id="mo5" name="installmentPeriod" value="5" />
        <label for="mo5">5 งวด</label>
        <input type="radio" id="mo6" name="installmentPeriod" value="6" />
        <label for="mo6">6 งวด</label>
        <input type="radio" id="mo7" name="installmentPeriod" value="7" />
        <label for="mo7">7 งวด</label>
        <input type="radio" id="mo8" name="installmentPeriod" value="8" />
        <label for="mo8">8 งวด</label>
        <input type="radio" id="mo9" name="installmentPeriod" value="9" />
        <label for="mo9">9 งวด</label>
        <input type="radio" id="mo10" name="installmentPeriod" value="10" />
        <label for="mo10">10 งวด</label>
        <input type="radio" id="mo11" name="installmentPeriod" value="11" />
        <label for="mo11">11 งวด</label>
        <input type="radio" id="mo12" name="installmentPeriod" value="12" />
        <label for="mo12">12 งวด</label>
      </div>
      <button onclick="cal()">คำนวณ</button>
      <div id="field"></div>
      <a href="index.html">
        <button style="background-color: red">ย้อนกลับ</button></a
      >
    </div>
  </body>
</html>
